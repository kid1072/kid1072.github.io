<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <title>星海引路人 - 拓客社团ME部门招新游戏</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
        // 配置Tailwind自定义颜色
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#89A707',
                        secondary: '#FFCA00',
                        neutral: '#E4EAE7',
                    },
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
        }
    </style>
</head>
<body class="bg-white font-sans text-gray-800">
    <div id="game-container" class="max-w-md mx-4 mx-auto bg-white p-6 rounded-xl shadow-lg mt-4 mb-8">
        <!-- 标题页 -->
        <div id="title-screen" class="text-center py-6">
            <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                <i class="fa fa-star text-white text-3xl"></i>
            </div>
            <h1 class="text-3xl font-bold text-gray-800 mb-2">星海引路人</h1>
            <p class="text-gray-600 mb-8">拓客社团ME关爱教育部门招新互动游戏</p>
            <button id="start-btn" class="bg-primary hover:bg-primary/90 text-white font-medium py-3 px-8 rounded-lg transition duration-300 transform hover:scale-105">
                开始游戏 <i class="fa fa-arrow-right ml-2 text-white"></i>
            </button>
        </div>

        <!-- 游戏主界面 -->
        <div id="game-screen" class="hidden rounded-lg p-4">
            <div class="mb-4 pb-4 border-b border-primary/20">
                <div class="flex items-center text-sm text-gray-500 mb-2">
                    <i class="fa fa-map-marker mr-2"></i>
                    <span id="progress-indicator">当前进度</span>
                </div>
                <div id="scene-container" class="text-lg leading-relaxed"></div>
            </div>
            <div id="choices-container" class="space-y-3"></div>
        </div>

        <!-- 结局页 -->
        <div id="ending-screen" class="hidden">
            <div id="screenshot-container">
                <!-- 用于生成分享图片的容器 -->
                <div id="share-image-container" class="bg-white rounded-xl p-6 mb-6">
                    <div class="w-20 h-20 bg-primary rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fa fa-star text-white text-3xl"></i>
                    </div>
                    <h2 id="ending-title" class="text-2xl font-bold mb-4 text-center"></h2>
                    <p id="ending-desc" class="text-gray-700 mb-6 leading-relaxed"></p>
                    <p id="ending-relation" class="font-semibold text-primary mb-6 text-center"></p>
                    <div class="text-center text-sm text-gray-500 mt-6 pt-4 border-t border-gray-200">
                        来自拓客社团「星海引路人」ME部门招新游戏
                    </div>
                </div>

                <!-- 招新说明部分 -->
                <div class="bg-neutral p-5 rounded-lg mb-6">
                    <h3 class="text-xl font-bold text-primary mb-3">关于 ME 关爱教育部门</h3>
                    <p class="text-gray-700 mb-3">
                        我们关注偏远地区、少数群体、社会边缘群体的教育发展和身心健康，致力于改善社会资源不均的现状。通过线上陪伴指导（如蓝信封、太阳语、星云计划等）和线下支教，让更多孩子感受到教育与陪伴的力量。
                    </p>
                    <p class="text-gray-700 italic mb-4">
                        "我们相信：用一棵树摇动另一棵树，用一朵云推动另一朵云，用一个灵魂唤醒另一个灵魂。"
                    </p>
                    <p class="text-primary font-bold mb-4">期待你的加入！</p>

                    <!-- 招新推送链接按钮 -->
                    <a href="https://example.com/me-recruitment" target="_blank" class="inline-block bg-primary hover:bg-primary/90 text-white font-medium py-2 px-6 rounded-lg transition duration-300 transform hover:scale-105">
                        <i class="fa fa-link mr-2"></i> 查看招新详情
                    </a>
                </div>
            </div>

            <!-- 分享按钮 -->
            <button id="share-btn" class="w-full bg-secondary hover:bg-secondary/90 text-gray-800 font-medium py-3 px-4 rounded-lg transition duration-300 mb-3">
                <i class="fa fa-share-alt mr-2"></i> 保存结果图片
            </button>
            <p class="text-xs text-gray-500 text-center mt-0 mb-3">
                若无法保存，请尝试截图
            </p>
            <button id="restart-btn" class="w-full bg-primary hover:bg-primary/90 text-white font-medium py-3 px-4 rounded-lg transition duration-300">
                <i class="fa fa-refresh mr-2"></i> 重新开始
            </button>
        </div>
    </div>

    <script>
        // --- 游戏核心逻辑 ---
                const gameData = {
            scenes: {
                start: {
                    text: "你是一名新晋志愿者，代号“引路人-9”。请选择你将参与的项目：",
                    choices: [
                        { text: "【星云计划】民族文化与自然探索", next: "nebula_1", path: "A" },
                        { text: "【蓝信封】书信陪伴留守儿童", next: "blueletter_1", path: "B" },
                        { text: "【太阳语】罕见病儿童辅导与陪伴", next: "sunshine_1", path: "C" }
                    ]
                },
                // 星云计划分支 (A)
                nebula_1: {
                    text: "你的学生小依对民族文化很感兴趣，但她的父母希望她把更多时间用在数学上。",
                    choices: [
                        { text: "坚持文化课程，设计“民族故事+数学”项目。", next: "nebula_2", path: "A1" },
                        { text: "先转向数学辅导，再寻找结合点。", next: "nebula_3", path: "A2" }
                    ]
                },
                nebula_2: {
                    text: "项目进展顺利，但父母认为是“不务正业”，要求暂停。",
                    choices: [
                        { text: "据理力争，展示项目对综合能力的提升。", next: "nebula_4", path: "A1a" },
                        { text: "寻求折中，改为每周一次的兴趣拓展。", next: "nebula_5", path: "A1b" }
                    ]
                },
                nebula_3: {
                    text: "你帮小依补了几周数学，她成绩有所提升，但对课程的热情不高。",
                    choices: [
                        { text: "继续强化数学，并尝试在题目中融入文化元素。", next: "nebula_6", path: "A2a" },
                        { text: "尊重她的兴趣，和家长沟通恢复文化课程。", next: "nebula_7", path: "A2b" }
                    ]
                },
                nebula_4: {
                    text: "家长态度强硬，甚至向项目负责人投诉你不按要求教学。",
                    choices: [
                        { text: "邀请负责人观摩课程，展示教学效果。", next: "nebula_8", path: "A1a1" },
                        { text: "暂时妥协，同时收集学生进步的证据。", next: "nebula_9", path: "A1a2" }
                    ]
                },
                nebula_5: {
                    text: "小依很珍惜每周一次的文化课程，但你发现她在课堂上越来越沉默。",
                    choices: [
                        { text: "课后单独和她交流，了解她的想法。", next: "nebula_10", path: "A1b1" },
                        { text: "增加课程趣味性，引入更多互动环节。", next: "nebula_11", path: "A1b2" }
                    ]
                },
                nebula_6: {
                    text: "小依的数学成绩持续提升，但你发现她偷偷在笔记本上画民族服饰。",
                    choices: [
                        { text: "肯定她的绘画，鼓励她创作与数学结合的作品。", next: "nebula_12", path: "A2a1" },
                        { text: "假装没看见，继续按计划完成数学教学。", next: "nebula_13", path: "A2a2" }
                    ]
                },
                nebula_7: {
                    text: "家长勉强同意恢复文化课程，但要求你保证不影响数学成绩。",
                    choices: [
                        { text: "制定双轨学习计划，明确学习目标和评估方式。", next: "nebula_14", path: "A2b1" },
                        { text: "先口头答应，后续用实际成果证明不冲突。", next: "nebula_15", path: "A2b2" }
                    ]
                },
                nebula_8: {
                    text: "负责人观摩后认可了你的教学理念，但建议你加强与家长的沟通方式。",
                    choices: [
                        { text: "定期向家长发送学习报告，展示综合能力提升。", next: "ending_A_success", path: "A1a1a" },
                        { text: "邀请家长参与部分课程，亲身体验教学效果。", next: "nebula_26", path: "A1a1b" },
                        { text: "组织亲子活动，在实践中展示教学成果", next: "nebula_39", path: "A1a1c" }
                    ]
                },
                nebula_9: {
                    text: "你收集了小依的作业和课堂表现，发现她的逻辑思维能力明显提升。",
                    choices: [
                        { text: "用数据说服家长，申请恢复原教学计划。", next: "ending_A_success", path: "A1a2a" },
                        { text: "设计更平衡的课程方案，争取家长支持。", next: "ending_A_compromise", path: "A1a2b" }
                    ]
                },
                nebula_10: {
                    text: "小依告诉你，她担心表现不好会失去这唯一的文化课程机会。",
                    choices: [
                        { text: "和她一起制定小目标，减轻心理压力。", next: "ending_good_teacher", path: "A1b1a" },
                        { text: "与家长沟通，强调兴趣对学习的积极影响。", next: "nebula_16", path: "A1b1b" }
                    ]
                },
                nebula_11: {
                    text: "新的互动环节很受欢迎，小依逐渐活跃起来，但教学进度变慢了。",
                    choices: [
                        { text: "保证质量，适当延长课程周期。", next: "ending_A_success", path: "A1b2a" },
                        { text: "优化内容，在趣味性和进度间找平衡。", next: "ending_A_compromise", path: "A1b2b" }
                    ]
                },
                nebula_12: {
                    text: "小依创作了一组以民族图案为主题的几何画作，获得了学校的表扬。",
                    choices: [
                        { text: "鼓励她参加民族文化创意比赛。", next: "ending_A_excellent", path: "A2a1a" },
                        { text: "将作品展示给家长，证明兴趣与学习的结合。", next: "ending_A_success", path: "A2a1b" }
                    ]
                },
                nebula_13: {
                    text: "小依的数学成绩名列前茅，但她的笔记本被父母发现，要求没收。",
                    choices: [
                        { text: "介入调解，建议设立“学习奖励时间”用于兴趣发展。", next: "ending_missed_opportunity", path: "A2a2a" },
                        { text: "尊重家长决定，课后帮她保留创作空间。", next: "ending_good_teacher", path: "A2a2b" }
                    ]
                },
                nebula_14: {
                    text: "双轨计划实施顺利，小依的数学成绩稳定，文化学习也很投入。",
                    choices: [
                        { text: "邀请她担任小老师，帮助其他同学。", next: "ending_A_excellent", path: "A2b1a" },
                        { text: "按计划完成学期内容，总结经验推广。", next: "ending_A_success", path: "A2b1b" }
                    ]
                },
                nebula_15: {
                    text: "小依在期末考试中数学进步明显，文化知识也更加丰富。",
                    choices: [
                        { text: "组织小型成果展示会，邀请家长参加。", next: "ending_A_success", path: "A2b2a" },
                        { text: "让小依向家长汇报收获，自己补充说明。", next: "ending_A_compromise", path: "A2b2b" }
                    ]
                },
                nebula_16: {
                    text: "家长态度有所松动，同意增加文化课程频率，但要求你提供更系统的教学方案。",
                    choices: [
                        { text: "制定详细的课程大纲和评估标准。", next: "ending_A_success", path: "A1b1b1" },
                        { text: "邀请家长参与课程设计，共同制定方案。", next: "ending_A_excellent", path: "A1b1b2" }
                    ]
                },
                // 星云计划新增分支
                nebula_26: {
                    text: "你设计的民族数学课程被其他学校关注，邀请你做教学分享",
                    choices: [
                        { text: "邀请小依和家长一起参与分享", next: "nebula_27", path: "A3a" },
                        { text: "整理课程材料形成手册供参考", next: "nebula_28", path: "A3b" },
                        { text: "组建教学团队共同开发课程包", next: "nebula_29", path: "A3c" }
                    ]
                },
                nebula_27: {
                    text: "小依在分享会上表现出色，但会后说紧张得睡不着觉",
                    choices: [
                        { text: "教她放松技巧，准备下次分享", next: "ending_A_excellent", path: "A3a1" },
                        { text: "建议她以文字形式分享，减少压力", next: "ending_A_success", path: "A3a2" }
                    ]
                },
                nebula_28: {
                    text: "课程手册发布后收到很多反馈，有老师提出修改建议",
                    choices: [
                        { text: "组织线上研讨会集体优化", next: "nebula_30", path: "A3b1" },
                        { text: "筛选核心建议进行针对性修改", next: "ending_A_success", path: "A3b2" }
                    ]
                },
                nebula_29: {
                    text: "团队开发中出现意见分歧，有人主张增加趣味性，有人侧重学术性",
                    choices: [
                        { text: "设计双版本课程满足不同需求", next: "ending_A_excellent", path: "A3c1" },
                        { text: "做用户调研确定核心方向", next: "nebula_31", path: "A3c2" }
                    ]
                },
                nebula_30: {
                    text: "优化后的课程被教育局采纳，成为地方特色课程",
                    choices: [
                        { text: "申请课题深入研究", next: "ending_A_excellent", path: "A3b1a" },
                        { text: "开展教师培训推广课程", next: "ending_A_success", path: "A3b1b" }
                    ]
                },
                nebula_31: {
                    text: "调研显示农村学校更需要趣味性，城市学校注重学术性",
                    choices: [
                        { text: "按地域开发差异化版本", next: "ending_A_excellent", path: "A3c2a" },
                        { text: "开发模块化课程自由组合", next: "ending_project_pioneer", path: "A3c2b" }
                    ]
                },
                nebula_39: {
                    text: "亲子活动非常成功，家长们亲身感受到孩子的成长",
                    choices: [
                        { text: "每月定期举办类似活动，形成长效机制", next: "ending_A_excellent", path: "A1a1c1" },
                        { text: "制作活动纪录片，展示给更多家长", next: "nebula_40", path: "A1a1c2" }
                    ]
                },
                nebula_40: {
                    text: "纪录片在当地教育论坛展播后反响热烈",
                    choices: [
                        { text: "将纪录片上传至网络平台扩大影响", next: "ending_project_pioneer", path: "A1a1c2a" },
                        { text: "联系媒体报道，推广这种教学模式", next: "ending_A_excellent", path: "A1a1c2b" }
                    ]
                },
                
                // 蓝信封分支 (B)
                blueletter_1: {
                    text: "通信伙伴阿木在信中提到他很迷茫，觉得读书没有用。",
                    choices: [
                        { text: "分享你的大学生活与困惑，告诉他探索的价值。", next: "blueletter_2", path: "B1" },
                        { text: "提供实际建议，鼓励他探索职业方向。", next: "blueletter_3", path: "B2" }
                    ]
                },
                blueletter_2: {
                    text: "阿木回信说你的分享让他很受触动，但家里希望他早点打工补贴家用。",
                    choices: [
                        { text: "鼓励他坚持学业，强调长期价值。", next: "blueletter_4", path: "B1a" },
                        { text: "理解他的家庭压力，探讨半工半读等可能性。", next: "blueletter_5", path: "B1b" }
                    ]
                },
                blueletter_3: {
                    text: "阿木采纳了你的建议，但在后续信件中，他提到自己感到孤独。",
                    choices: [
                        { text: "增加通信频率，更多地倾听和陪伴他。", next: "blueletter_6", path: "B2a" },
                        { text: "建议他多和身边的朋友、老师沟通。", next: "blueletter_7", path: "B2b" }
                    ]
                },
                blueletter_4: {
                    text: "阿木说他想继续读书，但担心自己基础太差跟不上。",
                    choices: [
                        { text: "帮他制定基础学习计划，逐步提升。", next: "blueletter_8", path: "B1a1" },
                        { text: "鼓励他不要怕起点低，分享自己克服困难的经历。", next: "blueletter_9", path: "B1a2" }
                    ]
                },
                blueletter_5: {
                    text: "阿木找到了一份周末兼职，但说工作很累，没时间写信了。",
                    choices: [
                        { text: "主动调整通信频率，减轻他的压力。", next: "blueletter_10", path: "B1b1" },
                        { text: "建议他合理安排时间，保持学习的连续性。", next: "blueletter_11", path: "B1b2" }
                    ]
                },
                blueletter_6: {
                    text: "你的频繁来信让阿木感受到了支持，但他开始依赖你的回复。",
                    choices: [
                        { text: "保持耐心，同时引导他建立自己的支持系统。", next: "blueletter_12", path: "B2a1" },
                        { text: "逐渐减少频率，鼓励他独立面对问题。", next: "blueletter_13", path: "B2a2" }
                    ]
                },
                blueletter_7: {
                    text: "阿木说他尝试和老师沟通，但感觉对方不理解他的处境。",
                    choices: [
                        { text: "教他一些沟通技巧，准备好具体问题再去交流。", next: "blueletter_14", path: "B2b1" },
                        { text: "建议他找学校的心理老师或信任的长辈倾诉。", next: "blueletter_15", path: "B2b2" }
                    ]
                },
                blueletter_8: {
                    text: "阿木按计划学习了一个月，有进步但不明显，有些灰心。",
                    choices: [
                        { text: "帮他分析原因，调整学习方法和目标。", next: "blueletter_16", path: "B1a1a" },
                        { text: "肯定他的努力，强调坚持的重要性。", next: "blueletter_17", path: "B1a1b" }
                    ]
                },
                blueletter_9: {
                    text: "你的经历鼓舞了阿木，他决定再试一个学期，但需要具体的学习帮助。",
                    choices: [
                        { text: "联系当地志愿者，为他提供线下辅导。", next: "blueletter_18", path: "B1a2a" },
                        { text: "自己利用业余时间准备学习资料寄给他。", next: "blueletter_19", path: "B1a2b" }
                    ]
                },
                blueletter_10: {
                    text: "你改为每月一封信，阿木回信说很想念以前的交流频率。",
                    choices: [
                        { text: "恢复每周通信，但缩短篇幅，减轻他的负担。", next: "blueletter_20", path: "B1b1a" },
                        { text: "保持每月一次，但内容更丰富，增加鼓励的话。", next: "blueletter_21", path: "B1b1b" }
                    ]
                },
                blueletter_11: {
                    text: "阿木尝试平衡工作和学习，但期中考试成绩下滑了。",
                    choices: [
                        { text: "建议他暂时减少工作时间，先稳住学习。", next: "blueletter_22", path: "B1b2a" },
                        { text: "帮他分析时间管理问题，优化日程安排。", next: "blueletter_23", path: "B1b2b" }
                    ]
                },
                blueletter_12: {
                    text: "在你的引导下，阿木开始和同学分享心事，人际关系有所改善。",
                    choices: [
                        { text: "鼓励他组织小型学习小组，共同进步。", next: "blueletter_24", path: "B2a1a" },
                        { text: "肯定他的成长，逐渐减少通信频率。", next: "ending_B_good", path: "B2a1b" }
                    ]
                },
                blueletter_13: {
                    text: "阿木对通信频率减少感到不安，担心你不再关心他。",
                    choices: [
                        { text: "解释原因，强调信任和他的成长，恢复适当频率。", next: "ending_B_success", path: "B2a2a" },
                        { text: "坚持减少频率，认为这是他独立的必经过程。", next: "ending_B_bittersweet", path: "B2a2b" }
                    ]
                },
                blueletter_14: {
                    text: "阿木用你教的方法和老师沟通，得到了一些实际帮助。",
                    choices: [
                        { text: "鼓励他总结经验，帮助其他有类似困扰的同学。", next: "ending_B_success", path: "B2b1a" },
                        { text: "继续支持他解决新出现的问题。", next: "ending_good_teacher", path: "B2b1b" }
                    ]
                },
                blueletter_15: {
                    text: "阿木找到了学校的心理老师，说感觉好多了，但仍想和你保持通信。",
                    choices: [
                        { text: "为他的进步高兴，调整通信内容为更轻松的话题。", next: "ending_B_success", path: "B2b2a" },
                        { text: "建议他逐渐独立，必要时再联系你。", next: "ending_B_good", path: "B2b2b" }
                    ]
                },
                blueletter_16: {
                    text: "调整方法后，阿木的学习效率提高了，他想报考县里的重点高中。",
                    choices: [
                        { text: "帮他收集备考资料和信息。", next: "ending_B_success", path: "B1a1a1" },
                        { text: "联系当地的学长学姐为他提供经验。", next: "ending_B_excellent", path: "B1a1a2" }
                    ]
                },
                blueletter_17: {
                    text: "阿木坚持学习，虽然进步缓慢，但从未放弃，他说你的鼓励是动力。",
                    choices: [
                        { text: "寄给他一份小礼物作为奖励和鼓励。", next: "ending_B_success", path: "B1a1b1" },
                        { text: "邀请他分享自己的坚持故事，鼓励更多人。", next: "ending_B_excellent", path: "B1a1b2" }
                    ]
                },
                blueletter_18: {
                    text: "当地志愿者开始帮助阿木，他的成绩有了明显提升。",
                    choices: [
                        { text: "与当地志愿者保持沟通，共同支持阿木。", next: "ending_B_success", path: "B1a2a1" },
                        { text: "逐渐退出，让阿木适应新的辅导模式。", next: "ending_good_teacher", path: "B1a2a2" }
                    ]
                },
                blueletter_19: {
                    text: "你寄的学习资料很受欢迎，阿木的同学也想借阅。",
                    choices: [
                        { text: "发动身边朋友一起收集资料，建立小型图书角。", next: "ending_B_excellent", path: "B1a2b1" },
                        { text: "指导阿木制作资料副本，与同学共享。", next: "ending_B_success", path: "B1a2b2" }
                    ]
                },
                blueletter_20: {
                    text: "恢复通信频率后，阿木状态很好，他说你的信是每周最期待的事。",
                    choices: [
                        { text: "保持这种模式直到学期结束。", next: "ending_B_success", path: "B1b1a1" },
                        { text: "慢慢引导他将这份期待转化为学习动力。", next: "ending_B_excellent", path: "B1b1a2" }
                    ]
                },
                blueletter_21: {
                    text: "你的长信让阿木感受到了持续的支持，他开始在信中分享自己的梦想。",
                    choices: [
                        { text: "帮他分析实现梦想的步骤和可能性。", next: "ending_B_success", path: "B1b1b1" },
                        { text: "鼓励他把梦想写下来，制定阶段性计划。", next: "ending_B_excellent", path: "B1b1b2" }
                    ]
                },
                blueletter_22: {
                    text: "阿木减少工作时间后，成绩回升，但家里经济压力增大。",
                    choices: [
                        { text: "帮助寻找更灵活且收入相当的兼职。", next: "ending_B_success", path: "B1b2a1" },
                        { text: "联系公益组织，申请助学补助。", next: "ending_B_excellent", path: "B1b2a2" }
                    ]
                },
                blueletter_23: {
                    text: "优化时间管理后，阿木能够平衡工作和学习，但非常疲惫。",
                    choices: [
                        { text: "建议他学习放松技巧，保证休息时间。", next: "ending_B_success", path: "B1b2b1" },
                        { text: "肯定他的努力，提醒他注意身体健康。", next: "ending_good_teacher", path: "B1b2b2" }
                    ]
                },
                // 蓝信封新增分支
                blueletter_24: {
                    text: "阿木想组织村里的孩子成立读书小组，但缺乏书籍和场地",
                    choices: [
                        { text: "发起线上捐书活动", next: "blueletter_25", path: "B3a" },
                        { text: "联系村支书协调场地，争取支持", next: "blueletter_26", path: "B3b" },
                        { text: "指导他们利用现有资源开展活动", next: "blueletter_27", path: "B3c" }
                    ]
                },
                blueletter_25: {
                    text: "收到大量捐赠书籍，但种类杂乱，孩子们不知如何选择",
                    choices: [
                        { text: "分类整理并编写推荐指南", next: "blueletter_28", path: "B3a1" },
                        { text: "组织读书分享会，让孩子们互相推荐", next: "blueletter_29", path: "B3a2" }
                    ]
                },
                blueletter_26: {
                    text: "村支书提供了闲置仓库，但需要简单修缮才能使用",
                    choices: [
                        { text: "发动村民志愿者共同修缮", next: "ending_community_builder", path: "B3b1" },
                        { text: "申请项目资金进行专业改造", next: "blueletter_30", path: "B3b2" }
                    ]
                },
                blueletter_27: {
                    text: "孩子们用简易条件开展活动，效果超出预期",
                    choices: [
                        { text: "记录他们的创新方法进行推广", next: "ending_B_excellent", path: "B3c1" },
                        { text: "联系媒体报道，争取更多资源", next: "blueletter_31", path: "B3c2" }
                    ]
                },
                blueletter_28: {
                    text: "推荐指南很受欢迎，附近村庄也想借鉴这种模式",
                    choices: [
                        { text: "帮助他们培训本地志愿者，实现自主运营", next: "ending_community_builder", path: "B3a1a" },
                        { text: "制作电子版指南，方便广泛传播", next: "ending_B_excellent", path: "B3a1b" }
                    ]
                },
                blueletter_29: {
                    text: "分享会激发了孩子们的阅读兴趣，有人提议建立轮换借阅制度",
                    choices: [
                        { text: "指导他们制定管理规则，培养责任感", next: "ending_B_success", path: "B3a2a" },
                        { text: "建议设立小管理员，负责协调借阅事务", next: "ending_community_builder", path: "B3a2b" }
                    ]
                },
                blueletter_30: {
                    text: "专业改造后的场地焕然一新，吸引了更多孩子参与",
                    choices: [
                        { text: "协助制定使用规范，确保可持续运营", next: "ending_B_excellent", path: "B3b2a" },
                        { text: "联系学校合作，将其作为课外实践基地", next: "ending_project_pioneer", path: "B3b2b" }
                    ]
                },
                blueletter_31: {
                    text: "媒体报道后获得企业赞助，提供了更多书籍和学习用品",
                    choices: [
                        { text: "建议企业设立长期助学计划", next: "ending_project_pioneer", path: "B3c2a" },
                        { text: "用赞助物资开展多样化的学习活动", next: "ending_B_excellent", path: "B3c2b" }
                    ]
                },

                // 太阳语分支 (C)
                sunshine_1: {
                    text: "学生小远因身体原因频繁请假，跟不上进度，感到非常沮丧。",
                    choices: [
                        { text: "调整目标，从建立自信入手，学习他感兴趣的内容。", next: "sunshine_2", path: "C1" },
                        { text: "提供情感支持，倾听他的感受并鼓励他接纳自己。", next: "sunshine_3", path: "C2" }
                    ]
                },
                sunshine_2: {
                    text: "小远在你的鼓励下，完成了一个他一直想做的小项目，重拾了自信。",
                    choices: [
                        { text: "将此作为新起点，设定更多他能完成的小目标。", next: "sunshine_4", path: "C1a" },
                        { text: "和他一起探索新的兴趣领域，保持学习的新鲜感。", next: "sunshine_5", path: "C1b" }
                    ]
                },
                sunshine_3: {
                    text: "小远向你敞开心扉，你也分享了如何调整心态面对困难。",
                    choices: [
                        { text: "推荐一些适合他的线上学习资源，帮助他自学。", next: "sunshine_6", path: "C2a" },
                        { text: "与项目组沟通，为他提供更灵活的辅导安排。", next: "sunshine_7", path: "C2b" }
                    ]
                },
                sunshine_4: {
                    text: "小远完成了几个小目标后，希望尝试更有挑战性的任务。",
                    choices: [
                        { text: "设计稍具难度但仍可完成的任务，逐步提升。", next: "sunshine_8", path: "C1a1" },
                        { text: "尊重他的决定，提供必要的支持和指导。", next: "sunshine_9", path: "C1a2" }
                    ]
                },
                sunshine_5: {
                    text: "你们一起探索了多个领域，小远对天文产生了浓厚兴趣。",
                    choices: [
                        { text: "帮助他深入学习天文知识，制定专题学习计划。", next: "sunshine_10", path: "C1b1" },
                        { text: "联系天文爱好者社群，让他获得更多交流机会。", next: "sunshine_11", path: "C1b2" }
                    ]
                },
                sunshine_6: {
                    text: "小远用你推荐的资源自学，但遇到难题时会感到挫败。",
                    choices: [
                        { text: "定期安排答疑时间，帮他解决难点。", next: "sunshine_12", path: "C2a1" },
                        { text: "教他如何寻找答案和求助的方法。", next: "sunshine_13", path: "C2a2" }
                    ]
                },
                sunshine_7: {
                    text: "项目组同意了灵活安排，但需要你提交详细的辅导计划。",
                    choices: [
                        { text: "与小远一起制定计划，尊重他的想法和节奏。", next: "sunshine_14", path: "C2b1" },
                        { text: "根据他的情况制定专业计划，再征求他的意见。", next: "sunshine_15", path: "C2b2" }
                    ]
                },
                sunshine_8: {
                    text: "小远在完成挑战性任务时遇到困难，情绪有些波动。",
                    choices: [
                        { text: "帮助他分解任务，降低难度，逐步完成。", next: "sunshine_16", path: "C1a1a" },
                        { text: "鼓励他坚持，相信他有能力克服困难。", next: "sunshine_17", path: "C1a1b" }
                    ]
                },
                sunshine_9: {
                    text: "小远选择的任务难度超出预期，多次尝试后仍未完成。",
                    choices: [
                        { text: "建议他调整目标，肯定他的努力和勇气。", next: "sunshine_18", path: "C1a2a" },
                        { text: "和他一起寻找新方法，不轻易放弃。", next: "sunshine_19", path: "C1a2b" }
                    ]
                },
                sunshine_10: {
                    text: "小远的天文知识日益丰富，他想制作一个小型天文观测报告。",
                    choices: [
                        { text: "指导他完成报告，并帮助他联系发表渠道。", next: "sunshine_20", path: "C1b1a" },
                        { text: "鼓励他将报告分享给其他同学，增强自信。", next: "sunshine_21", path: "C1b1b" }
                    ]
                },
                sunshine_11: {
                    text: "小远加入了天文社群，认识了许多有共同兴趣的朋友。",
                    choices: [
                        { text: "支持他参与社群活动，拓展社交圈。", next: "sunshine_22", path: "C1b2a" },
                        { text: "帮助他平衡线上交流和学习时间。", next: "sunshine_23", path: "C1b2b" }
                    ]
                },
                sunshine_12: {
                    text: "定期答疑帮助小远解决了困难，但他依赖你的程度也增加了。",
                    choices: [
                        { text: "逐渐减少答疑次数，培养他的独立思考能力。", next: "sunshine_24", path: "C2a1a" },
                        { text: "保持答疑频率，同时教他如何自主学习。", next: "sunshine_25", path: "C2a1b" }
                    ]
                },
                sunshine_13: {
                    text: "小远学会了自主解决问题，还帮助了其他有类似困难的同学。",
                    choices: [
                        { text: "鼓励他成为小老师，分享自己的学习方法。", next: "sunshine_26", path: "C2a2a" },
                        { text: "支持他继续深入学习，探索更多领域。", next: "sunshine_27", path: "C2a2b" }
                    ]
                },
                sunshine_14: {
                    text: "小远参与制定的计划执行顺利，他的学习主动性明显提高。",
                    choices: [
                        { text: "引导他制定长期学习目标，规划未来发展。", next: "sunshine_28", path: "C2b1a" },
                        { text: "保持现状，让他享受自主学习的乐趣。", next: "sunshine_29", path: "C2b1b" }
                    ]
                },
                sunshine_15: {
                    text: "小远对你制定的计划基本满意，但希望增加一些自己感兴趣的内容。",
                    choices: [
                        { text: "调整计划，融入他的兴趣点。", next: "sunshine_30", path: "C2b2a" },
                        { text: "解释计划的科学性，建议他在课余时间探索兴趣。", next: "sunshine_31", path: "C2b2b" }
                    ]
                },
                sunshine_16: {
                    text: "分解任务后，小远顺利完成了挑战，自信心大增。",
                    choices: [
                        { text: "鼓励他尝试更大的挑战，相信他的能力。", next: "ending_A_success", path: "C1a1a1" },
                        { text: "帮助他总结经验，为未来的挑战做准备。", next: "ending_good_teacher", path: "C1a1a2" }
                    ]
                },
                sunshine_17: {
                    text: "在你的鼓励下，小远坚持不懈，最终完成了任务，收获了成就感。",
                    choices: [
                        { text: "帮他记录这个过程，制作成纪念册。", next: "ending_A_success", path: "C1a1b1" },
                        { text: "邀请他分享自己的经历，鼓励其他同学。", next: "ending_A_excellent", path: "C1a1b2" }
                    ]
                },
                sunshine_18: {
                    text: "调整目标后，小远成功完成了任务，他学会了灵活面对困难。",
                    choices: [
                        { text: "肯定他的成长，讨论如何设定合理目标。", next: "ending_good_teacher", path: "C1a2a1" },
                        { text: "鼓励他以后遇到类似情况时，尝试自己调整。", next: "ending_independent_learner", path: "C1a2a2" }
                    ]
                },
                sunshine_19: {
                    text: "经过多次尝试和方法调整，小远终于完成了任务。",
                    choices: [
                        { text: "帮他总结成功经验，形成自己的解决问题模式。", next: "ending_independent_learner", path: "C1a2b1" },
                        { text: "庆祝他的成功，给予适当奖励。", next: "ending_A_success", path: "C1a2b2" }
                    ]
                },
                sunshine_20: {
                    text: "小远的天文报告获得了专业人士的肯定，他非常开心。",
                    choices: [
                        { text: "支持他继续深入研究，培养科研兴趣。", next: "ending_A_excellent", path: "C1b1a1" },
                        { text: "鼓励他将兴趣转化为学习动力，全面发展。", next: "ending_A_success", path: "C1b1a2" }
                    ]
                },
                sunshine_21: {
                    text: "小远的报告很受欢迎，同学们的认可让他更加自信。",
                    choices: [
                        { text: "帮助他准备更多分享内容，提升表达能力。", next: "ending_A_success", path: "C1b1b1" },
                        { text: "鼓励他组织小型天文兴趣小组，带动更多人。", next: "ending_A_excellent", path: "C1b1b2" }
                    ]
                },
                sunshine_22: {
                    text: "小远在社群中很活跃，甚至帮助解答其他成员的问题。",
                    choices: [
                        { text: "肯定他的贡献，鼓励他发挥领导力。", next: "ending_A_excellent", path: "C1b2a1" },
                        { text: "提醒他注意休息，保持适度参与。", next: "ending_good_teacher", path: "C1b2a2" }
                    ]
                },
                sunshine_23: {
                    text: "小远能够很好地平衡线上交流和学习，各方面都有进步。",
                    choices: [
                        { text: "鼓励他分享自己的时间管理方法。", next: "ending_independent_learner", path: "C1b2b1" },
                        { text: "帮他设定新的学习目标，继续提升。", next: "ending_A_success", path: "C1b2b2" }
                    ]
                },
                sunshine_24: {
                    text: "减少答疑后，小远虽然有些不适应，但逐渐学会了独立解决问题。",
                    choices: [
                        { text: "肯定他的进步，给予适当的奖励和鼓励。", next: "ending_independent_learner", path: "C2a1a1" },
                        { text: "与他讨论未来的学习计划，提供必要的指导。", next: "ending_good_teacher", path: "C2a1a2" }
                    ]
                },
                sunshine_25: {
                    text: "在你的指导下，小远掌握了多种自主学习方法，学习效率显著提高。",
                    choices: [
                        { text: "鼓励他将这些方法整理成手册，帮助更多同学。", next: "ending_A_excellent", path: "C2a1b1" },
                        { text: "支持他根据自己的节奏探索新的学习领域。", next: "ending_independent_learner", path: "C2a1b2" }
                    ]
                },
                sunshine_26: {
                    text: "小远作为小老师很受欢迎，其他同学也从他的方法中受益。",
                    choices: [
                        { text: "协助他设计更系统的分享课程，扩大影响。", next: "ending_A_excellent", path: "C2a2a1" },
                        { text: "建议成立互助小组，让大家互相学习。", next: "ending_A_success", path: "C2a2a2" }
                    ]
                },
                sunshine_27: {
                    text: "小远在新领域的探索中表现出色，展现了很强的学习能力。",
                    choices: [
                        { text: "帮他联系相关领域的专业人士进行指导。", next: "ending_A_excellent", path: "C2a2b1" },
                        { text: "鼓励他保持好奇心，继续广泛探索。", next: "ending_independent_learner", path: "C2a2b2" }
                    ]
                },
                sunshine_28: {
                    text: "小远制定的长期目标很有挑战性，但他充满动力去实现。",
                    choices: [
                        { text: "帮助他分解长期目标，制定阶段性计划。", next: "ending_A_success", path: "C2b1a1" },
                        { text: "联系相关资源和人脉，为他提供支持。", next: "ending_A_excellent", path: "C2b1a2" }
                    ]
                },
                sunshine_29: {
                    text: "小远在自主学习中找到了乐趣，成绩和自信心都有很大提升。",
                    choices: [
                        { text: "鼓励他记录自己的学习心得，分享给更多人。", next: "ending_A_success", path: "C2b1b1" },
                        { text: "支持他尝试将兴趣与公益结合，帮助他人。", next: "ending_A_excellent", path: "C2b1b2" }
                    ]
                },
                sunshine_30: {
                    text: "融入兴趣点的计划让小远学习热情高涨，进步明显。",
                    choices: [
                        { text: "总结这种方法，向项目组推荐推广。", next: "ending_project_pioneer", path: "C2b2a1" },
                        { text: "帮助其他同学也制定类似的个性化计划。", next: "ending_A_excellent", path: "C2b2a2" }
                    ]
                },
                sunshine_31: {
                    text: "小远在课余时间探索兴趣的同时，也能按计划完成学习任务。",
                    choices: [
                        { text: "肯定他的平衡能力，鼓励他分享时间管理经验。", next: "ending_independent_learner", path: "C2b2b1" },
                        { text: "建议他尝试将兴趣与学习内容结合，提高效率。", next: "ending_A_success", path: "C2b2b2" }
                    ]
                },
                // 太阳语新增分支
                sunshine_32: {
                    text: "小远想为其他患病儿童制作科普视频，但缺乏设备和技术",
                    choices: [
                        { text: "发起众筹购买简易设备", next: "sunshine_33", path: "C3a" },
                        { text: "教授手机拍摄剪辑技巧，利用现有工具", next: "sunshine_34", path: "C3b" },
                        { text: "联系传媒专业学生志愿者协助", next: "sunshine_35", path: "C3c" }
                    ]
                },
                sunshine_33: {
                    text: "众筹超额完成，但有捐赠者希望指定视频内容",
                    choices: [
                        { text: "平衡捐赠者意愿与孩子们的需求", next: "sunshine_36", path: "C3a1" },
                        { text: "坚持以孩子们的兴趣为主，做好沟通", next: "sunshine_37", path: "C3a2" }
                    ]
                },
                sunshine_34: {
                    text: "手机拍摄的视频质量有限，但真实感人",
                    choices: [
                        { text: "突出真实感，制作系列纪实短片", next: "ending_C_excellent", path: "C3b1" },
                        { text: "邀请专业人士进行后期优化", next: "sunshine_38", path: "C3b2" }
                    ]
                },
                sunshine_35: {
                    text: "传媒专业学生带来了专业设备，但与小远的沟通出现障碍",
                    choices: [
                        { text: "协助双方理解彼此需求，做好沟通桥梁", next: "sunshine_39", path: "C3c1" },
                        { text: "建议先制作样片，根据反馈调整合作方式", next: "sunshine_40", path: "C3c2" }
                    ]
                },
                sunshine_36: {
                    text: "平衡方案获得双方认可，视频系列开始制作",
                    choices: [
                        { text: "建立内容审核机制，确保质量", next: "ending_project_pioneer", path: "C3a1a" },
                        { text: "邀请捐赠者参与录制，增强参与感", next: "ending_C_excellent", path: "C3a1b" }
                    ]
                },
                sunshine_37: {
                    text: "捐赠者理解并支持以孩子为中心的理念，还介绍了更多资源",
                    choices: [
                        { text: "利用新资源拓展视频内容形式", next: "ending_C_excellent", path: "C3a2a" },
                        { text: "成立小型制作团队，实现可持续创作", next: "ending_project_pioneer", path: "C3a2b" }
                    ]
                },
                sunshine_38: {
                    text: "专业人士优化后的视频质量大幅提升，获得广泛关注",
                    choices: [
                        { text: "与医疗机构合作，扩大科普影响力", next: "ending_project_pioneer", path: "C3b2a" },
                        { text: "开展视频制作工作坊，培养更多小创作者", next: "ending_C_excellent", path: "C3b2b" }
                    ]
                },
                sunshine_39: {
                    text: "沟通顺畅后，合作效率提高，产出了高质量视频",
                    choices: [
                        { text: "总结合作模式，推广到其他公益项目", next: "ending_project_pioneer", path: "C3c1a" },
                        { text: "促成长期合作，建立稳定的创作团队", next: "ending_C_excellent", path: "C3c1b" }
                    ]
                },
                sunshine_40: {
                    text: "样片测试反响良好，双方找到了最佳合作方式",
                    choices: [
                        { text: "制定详细分工表，明确各自职责", next: "ending_C_excellent", path: "C3c2a" },
                        { text: "申请创新创业项目，将模式规模化", next: "ending_project_pioneer", path: "C3c2b" }
                    ]
                },

                // 结局
                ending_A_success: {
                    title: "文化传承者",
                    desc: "你成功平衡了民族文化传承与学科教育，让小依在保持兴趣的同时也取得了学业进步。你的耐心和创造力赢得了家长和学生的认可。",
                    relation: "ME部门需要你这样能平衡多方需求的协调者"
                },
                ending_A_excellent: {
                    title: "教育创新者",
                    desc: "你不仅实现了文化与教育的融合，还开发出可推广的教学模式，让更多孩子受益。你的创新思维和执行力是项目成功的关键。",
                    relation: "ME部门的教育创新项目正等待你的加入"
                },
                ending_A_compromise: {
                    title: "灵活协调者",
                    desc: "你在坚持教育理念的同时，也学会了灵活变通，通过妥协和调整找到各方都能接受的方案。这种平衡能力在公益项目中非常宝贵。",
                    relation: "ME部门的项目协调工作需要你的智慧"
                },
                ending_B_success: {
                    title: "心灵陪伴者",
                    desc: "你用真诚的陪伴和有效的沟通，帮助阿木走出了迷茫，找到了学习的动力和方向。你的倾听和支持成为了他成长路上的重要力量。",
                    relation: "ME部门的书信陪伴项目需要你这样的志愿者"
                },
                ending_B_excellent: {
                    title: "成长引路人",
                    desc: "你不仅陪伴阿木成长，还帮助他建立了支持系统，影响了更多同龄人。你的远见和执行力让公益的力量得到了延伸。",
                    relation: "ME部门的项目拓展工作适合有你这样视野的人"
                },
                ending_B_good: {
                    title: "真诚沟通者",
                    desc: "你的真诚和同理心赢得了阿木的信任，虽然没有惊天动地的成果，但你的陪伴本身就给了他巨大的力量。有时候，陪伴就是最好的帮助。",
                    relation: "ME部门的一对一帮扶项目需要你这样的志愿者"
                },
                ending_B_bittersweet: {
                    title: "坚定的成长派",
                    desc: "你坚信独立是成长的必经之路，虽然过程中有些波折，但阿木最终学会了独自面对困难。你的坚持虽然有些“狠心”，但为他的未来奠定了基础。",
                    relation: "ME部门的能力建设项目适合你的理念"
                },
                ending_C_excellent: {
                    title: "特殊教育能手",
                    desc: "你不仅帮助小远克服了身体带来的困难，还发掘了他的潜能，让他找到了自信和价值。你的专业和爱心是特殊教育中最宝贵的品质。",
                    relation: "ME部门的特殊儿童关爱项目需要你这样的人才"
                },
                ending_good_teacher: {
                    title: "暖心教育者",
                    desc: "你用爱心和耐心赢得了学生的信任，成为了他们可以依靠的老师。虽然没有轰轰烈烈的成就，但你的每一次付出都温暖着孩子们的心灵。",
                    relation: "ME部门的所有项目都需要你这样有爱心的志愿者"
                },
                ending_independent_learner: {
                    title: "能力培养师",
                    desc: "你成功培养了学生的自主学习能力，让他们即使在没有你的情况下也能继续成长。这种“授人以渔”的智慧，是教育的最高境界。",
                    relation: "ME部门的能力建设项目非常适合你"
                },
                ending_missed_opportunity: {
                    title: "遗憾的平衡者",
                    desc: "你努力在家长要求和学生兴趣间寻找平衡，虽然避免了冲突，但也错过了让学生全面发展的机会。有时候，适当的坚持可能会带来更好的结果。",
                    relation: "ME部门相信你能在实践中不断成长"
                },
                // 新增结局
                ending_project_pioneer: {
                    title: "项目先锋",
                    desc: "你不仅完成了基础教学任务，更开拓了新的教学模式，为项目发展做出了突破性贡献。你的创新思维和执行力让更多人受益。",
                    relation: "ME部门需要你这样的创新者"
                },
                ending_community_builder: {
                    title: "社区建设者",
                    desc: "你成功连接了多方资源，在帮助个体的同时推动了社区发展，形成了可持续的互助模式，展现了强大的协调能力。",
                    relation: "ME部门的社区项目等待你的加入"
                }
            }
        };

        // 游戏状态管理
        const gameState = {
            currentScene: 'start',
            path: []
        };

        // DOM 元素
        const titleScreen = document.getElementById('title-screen');
        const gameScreen = document.getElementById('game-screen');
        const endingScreen = document.getElementById('ending-screen');
        const startBtn = document.getElementById('start-btn');
        const restartBtn = document.getElementById('restart-btn');
        const shareBtn = document.getElementById('share-btn');
        const sceneContainer = document.getElementById('scene-container');
        const choicesContainer = document.getElementById('choices-container');
        const progressIndicator = document.getElementById('progress-indicator');
        const endingTitle = document.getElementById('ending-title');
        const endingDesc = document.getElementById('ending-desc');
        const endingRelation = document.getElementById('ending-relation');
        const shareImageContainer = document.getElementById('share-image-container');

        // 初始化游戏
        function initGame() {
            startBtn.addEventListener('click', startGame);
            restartBtn.addEventListener('click', restartGame);
            shareBtn.addEventListener('click', captureAndShare);
        }

        // 开始游戏
        function startGame() {
            titleScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            loadScene('start');
        }

        // 重新开始
        function restartGame() {
            gameState.currentScene = 'start';
            gameState.path = [];
            endingScreen.classList.add('hidden');
            gameScreen.classList.remove('hidden');
            loadScene('start');
        }

        // 加载场景
        function loadScene(sceneId) {
            const scene = gameData.scenes[sceneId];
            if (!scene) return;

            gameState.currentScene = sceneId;
            sceneContainer.textContent = scene.text;
            //progressIndicator.textContent = `路径: ${gameState.path.join(' > ')}`;
            renderChoices(scene.choices);
        }

        // 渲染选择项
        function renderChoices(choices) {
            choicesContainer.innerHTML = '';
            if (!choices) {
                setTimeout(() => showEnding(gameState.currentScene), 1000);
                return;
            }
            choices.forEach(choice => {
                const button = document.createElement('button');
                button.className = 'w-full bg-neutral hover:bg-neutral/80 text-gray-800 font-medium py-3 px-4 rounded-lg transition duration-300 text-left';
                button.innerHTML = `<i class="fa fa-angle-right mr-2 text-primary"></i> ${choice.text}`;
                button.addEventListener('click', () => {
                    gameState.path.push(choice.path);
                    loadScene(choice.next);
                });
                choicesContainer.appendChild(button);
            });
        }

        // 显示结局
        function showEnding(endingId) {
            const ending = gameData.scenes[endingId];
            if (!ending) return;
            endingTitle.textContent = ending.title;
            endingDesc.textContent = ending.desc;
            endingRelation.textContent = ending.relation;
            gameScreen.classList.add('hidden');
            endingScreen.classList.remove('hidden');
        }

        // 生成并分享结果图片（兼容微信/IOS）
        function captureAndShare() {
            html2canvas(shareImageContainer, {
                useCORS: true,
                scale: 2
            }).then(canvas => {
                const dataUrl = canvas.toDataURL('image/png');
                const ua = navigator.userAgent.toLowerCase();
                const isWeChat = ua.indexOf('micromessenger') !== -1;
                const isIOS = /iphone|ipad|ipod/.test(ua);

                if (isWeChat || isIOS) {
                    // 微信 / iOS 下展示图片，提示长按保存
                    const modal = document.createElement('div');
                    modal.style.position = 'fixed';
                    modal.style.top = '0';
                    modal.style.left = '0';
                    modal.style.width = '100%';
                    modal.style.height = '100%';
                    modal.style.background = 'rgba(0,0,0,0.8)';
                    modal.style.display = 'flex';
                    modal.style.flexDirection = 'column';
                    modal.style.justifyContent = 'center';
                    modal.style.alignItems = 'center';
                    modal.style.zIndex = '9999';

                    const img = document.createElement('img');
                    img.src = dataUrl;
                    img.style.maxWidth = '90%';
                    img.style.borderRadius = '12px';
                    img.style.boxShadow = '0 4px 12px rgba(0,0,0,0.3)';

                    const tip = document.createElement('p');
                    tip.innerText = '长按图片保存到相册';
                    tip.style.color = '#fff';
                    tip.style.marginTop = '16px';
                    tip.style.fontSize = '14px';

                    modal.appendChild(img);
                    modal.appendChild(tip);
                    document.body.appendChild(modal);

                    modal.addEventListener('click', () => {
                        document.body.removeChild(modal);
                    });
                } else {
                    // 其他浏览器自动下载
                    const link = document.createElement('a');
                    link.download = '星海引路人-结果.png';
                    link.href = dataUrl;
                    link.click();
                }
            });
        }

        // 启动游戏
        document.addEventListener('DOMContentLoaded', initGame);
    </script>
</body>
</html>
